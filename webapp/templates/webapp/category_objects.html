{% extends 'main/base.html' %}
{% load static %}
{% load currency_filters %}


{% block content %}


    <div class="city-header"
         {% if city.photo %}
         style="background-image: url('{{ city.photo.url }}');"
         {% endif %}>
        {{ city.name }}
    </div>
<h1>–°–ø–∏—Å–æ–∫ –≥–æ—Ä–æ–¥–æ–≤</h1>
<ul>
  {% for city in cities %}
    <li><a href="{% url 'city_detail' slug=city.slug %}">{{ city.name }}</a></li>
  {% empty %}
    <li>–ì–æ—Ä–æ–¥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</li>
  {% endfor %}
</ul>



    <section>
        <div class="listing-wrapper">
            <h1 class="page-title">–û–±—ä–µ–∫—Ç—ã –¥–ª—è –ø–æ–∫—É–ø–∫–∏</h1>

            {% if properties %}
                <div class="listing-cards">
                    {% for property in properties %}
                        <article class="listing-card">
                            <h2 class="listing-title">
                                <a href="{% url 'sale_single' property.slug %}" class="listing-link">
                                    {{ property.name }}
                                </a>
                            </h2>

                            <p><b>–¢–∏–ø:</b>
                                {% if property.is_active_apartment %}
                                    –ö–≤–∞—Ä—Ç–∏—Ä–∞
                                {% elif property.is_active_house %}
                                    –î–æ–º
                                {% elif property.is_active_country_house %}
                                    –î–∞—á–∞
                                {% elif property.is_active_new %}
                                    –ù–æ–≤–æ—Å—Ç—Ä–æ–π–∫–∞
                                {% else %}
                                    –î—Ä—É–≥–æ–µ
                                {% endif %}
                            </p>
                            <p><b>–≠—Ç–∞–∂:</b> {{ property.floor|default:"–ù–µ —É–∫–∞–∑–∞–Ω–æ" }}</p>
                            <p><b>–ö–æ–º–Ω–∞—Ç:</b> {{ property.many_rooms|default:"–ù–µ —É–∫–∞–∑–∞–Ω–æ" }}</p>
                            <p><b>–ü–ª–æ—â–∞–¥—å:</b> {{ property.area|default:"–ù–µ —É–∫–∞–∑–∞–Ω–æ" }} –º¬≤
                                {% if property.area_ga %}
                                    ({{ property.area_ga }} —Å–æ—Ç./–≥–∞)
                                {% endif %}
                            </p>
                            <p><b>–¶–µ–Ω–∞ BYN:</b>
                                {% if property.price %}
                                    <span class="price-sale">{{ property.price|multiply:usd_to_byn_rate|floatformat:2 }}</span>
                                {% else %}
                                    <span>–¶–µ–Ω–∞ –Ω–µ —É–∫–∞–∑–∞–Ω–∞</span>
                                {% endif %}
                            </p>
                            {% if usd_to_byn_rate and property.price %}
                                <p><b>–¶–µ–Ω–∞ –≤ USD: $</b> <span
                                        class="price-sale">{{ property.price|floatformat:2 }}</span></p>
                            {% else %}
                                <p>–¶–µ–Ω–∞ USD: $–Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞</p>
                            {% endif %}

                            <p class="listing-description">{{ property.description|default:"–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç"|safe|truncatewords:13 }}</p>

                            <a href="{% url 'sale_single' property.slug %}" class="listing-photo-link">
                                {% if property.photos.all %}
                                    {% with photo=property.photos.all.0 %}
                                        {% if photo.photo %}
                                            <div class="listing-photo-wrapper">
                                                <img src="{{ photo.photo.url }}" alt="{{ photo.alt_text|default:'' }}"
                                                     class="listing-photo"/>
                                            </div>
                                        {% else %}
                                            <div class="listing-photo-wrapper no-photo">
                                                <span>–§–æ—Ç–æ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç</span>
                                            </div>
                                        {% endif %}
                                    {% endwith %}
                                {% else %}
                                    <div class="listing-photo-wrapper no-photo">
                                        <span>–§–æ—Ç–æ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç</span>
                                    </div>
                                {% endif %}
                            </a>
                        </article>
                    {% endfor %}
                </div>
            {% else %}
                <div class="no-listings">
                    <p class="no-listings-message">
                        üí°‚ö†Ô∏èü§∑‚Äç‚ôÇÔ∏è –ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –æ–±—ä–µ–∫—Ç—ã –ø–æ –≤–∞—à–µ–º—É –∑–∞–ø—Ä–æ—Å—É –Ω–µ –Ω–∞–π–¥–µ–Ω—ã.
                        <br>
                        ‚úîÔ∏è –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑, –ø–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞–∑–∞–¥ ‚ôªÔ∏è
                        <a href="javascript:history.back()" class="btn-back">‚Üê –ù–∞–∑–∞–¥</a>
                    </p>
                </div>
            {% endif %}
        </div>
    </section>
{% endblock %}
