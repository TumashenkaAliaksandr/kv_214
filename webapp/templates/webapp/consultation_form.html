{% load static %}

{% block content %}

  <!-- –§–æ—Ä–º–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ -->
  <section class="consultation-form-section" id="consultation-form">
      <h2>üó£ –ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é</h2>
      <form id="consultationForm" class="consultation-form" method="post">
          {% csrf_token %}
          <label for="name">–ò–º—è</label>
          <input type="text" id="name" name="name" required placeholder="–í–∞—à–µ –∏–º—è"/>

          <label for="phone">–¢–µ–ª–µ—Ñ–æ–Ω</label>
          <input type="tel" id="phone" name="phone" required placeholder="+7 (___) ___-__-__"/>

          <div class="checkbox-wrapper">
              <input type="radio" id="agree" name="agree" required/>
              <label for="agree">–Ø —Å–æ–≥–ª–∞—Å–µ–Ω —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏</label>
          </div>

          <button type="submit" class="btn-submit">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É</button>
      </form>
      <div id="formMessage" style="margin-top: 15px;"></div>
  </section>

  <script>
  document.getElementById('consultationForm').addEventListener('submit', function(event) {
    event.preventDefault();

    const form = event.target;
    const formData = new FormData(form);

    fetch("{% url 'consultation_form' %}", {
      method: 'POST',
      headers: {
        'X-CSRFToken': formData.get('csrfmiddlewaretoken'),
      },
      body: formData
    })
    .then(response => response.json())
    .then(data => {
      const messageDiv = document.getElementById('formMessage');
      if (data.success) {
        messageDiv.style.color = 'green';
        messageDiv.textContent = data.message || '–°–ø–∞—Å–∏–±–æ! –í–∞—à –∑–∞–ø—Ä–æ—Å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω.';
        form.reset();
      } else {
        messageDiv.style.color = 'red';
        messageDiv.textContent = data.message || '–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ñ–æ—Ä–º—ã.';
      }
    })
    .catch(() => {
      const messageDiv = document.getElementById('formMessage');
      messageDiv.style.color = 'red';
      messageDiv.textContent = '–û—à–∏–±–∫–∞ —Å–µ—Ç–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.';
    });
  });
  </script>

{% endblock %}
